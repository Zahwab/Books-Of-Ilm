<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Books of Ilm ‚Äì For The Ummah</title>
  <style>
    /* 0. IMPORT & ROOT VARIABLES */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

    :root {
      --bg: #fafafa;
      --fg: #1a1a1a;
      --muted: #4a4a4a;
      --surface: #ffffff;
      --border: #d8d8d8;
      --primary: #00796b;
      --accent: #ff8f00;
      --alt: #f1fcfb;
    }

    body.dark {
      --bg: #121212;
      --fg: #eaeaea;
      --muted: #b0b0b0;
      --surface: #1e1e1e;
      --border: #2c2c2c;
      --primary: #26c6da;
      --accent: #ffb956;
      --alt: #181818;
    }

    /* 1. RESET & BASE */
    *,
    *::before,
    *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: var(--bg);
      color: var(--fg);
      font: clamp(16px, 1.8vw, 18px)/1.6 'Inter', sans-serif;
      letter-spacing: .3px;
      transition: background .3s, color .3s;
      overflow-x: hidden;
    }

    ::selection {
      background: var(--accent);
      color: var(--surface);
    }

    h1,
    h2,
    h3,
    h4 {
      color: var(--fg);
      font-weight: 600;
      letter-spacing: .5px;
      margin-bottom: .5em;
    }

    h1 {
      font-size: 2.8rem;
    }

    h2 {
      font-size: 2.2rem;
    }

    h3 {
      font-size: 1.6rem;
    }

    p,
    ul,
    ol,
    li,
    label {
      margin-bottom: 1em;
      color: var(--fg);
    }

    a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 500;
      transition: color .2s;
    }

    a:hover,
    a:focus {
      color: var(--accent);
      outline: 2px dotted var(--accent);
    }

    /* 2. LAYOUT CONTAINERS */
    .container {
      max-width: 1200px;
      width: 90%;
      margin: 0 auto;
      padding: 3em 0;
      border-radius: 12px;
    }

    .alt {
      background: var(--alt);
      border-radius: 12px;
    }

    /* 3. NAVBAR */
    .sticky {
      position: sticky;
      top: 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(255, 255, 255, .95);
      backdrop-filter: blur(6px);
      padding: 1em 2%;
      box-shadow: 0 2px 6px rgba(0, 0, 0, .05);
      z-index: 1000;
      border-radius: 0 0 12px 12px;
    }

    body.dark .sticky {
      background: rgba(18, 18, 18, .95);
    }

    .logo {
      font-size: 1.5em;
      color: var(--primary);
      font-weight: 600;
    }

    /* Utility Header - Base Styling */
    .utility {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      z-index: 1001;
    }

    /* Desktop Menu */
    .menu {
      list-style: none;
      display: flex;
      gap: 1.5em;
      z-index: 1100;
    }

    .menu a {
      padding: .2em;
      color: var(--fg);
    }

    .menu a:hover,
    .menu a:focus {
      color: var(--primary);
      outline: 2px dotted var(--primary);
    }

    .has-sub {
      position: relative;
    }

    .submenu {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      background: var(--surface);
      border: 1px solid var(--border);
      list-style: none;
      padding: .5em 0;
      border-radius: 0 0 8px 8px;
    }

    .has-sub:hover .submenu,
    .has-sub:focus-within .submenu {
      display: block;
    }

    /* 4. HAMBURGER MENU (ACCESSIBLE BUTTON) */
    .hamburger {
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 36px;
      height: 36px;
      padding: 6px;
      border: none;
      background: rgba(255, 255, 255, 0.85);
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.3s ease, background 0.3s ease;
      position: absolute;
      top: 1rem;
      right: 1rem;
      z-index: 1200;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      backdrop-filter: blur(6px);
    }

    .hamburger:active {
      transform: scale(0.95);
    }

    .hamburger span {
      display: block;
      width: 100%;
      height: 5px;
      background: #4af;
      border: 2px solid #333;
      box-shadow: 2px 2px 0px #111;
      margin: 4px 0;
      transition: transform 0.4s ease, opacity 0.3s ease;
      animation: pixelBounce 1.5s infinite ease-in-out;
    }

    .hamburger.active span:nth-child(1) {
      transform: translateY(9px) rotate(45deg);
    }

    .hamburger.active span:nth-child(2) {
      opacity: 0;
    }

    .hamburger.active span:nth-child(3) {
      transform: translateY(-9px) rotate(-45deg);
    }

    body.dark .hamburger span {
      background: var(--accent);
      border-color: var(--surface);
      box-shadow: 2px 2px 4px rgba(255, 143, 0, 0.4);
    }

    body.dark .hamburger:hover {
      background: rgba(30, 30, 30, 1);
      box-shadow: 0 0 16px rgba(255, 143, 0, 0.6);
    }

    /* Pixel Bounce Animation */
    @keyframes pixelBounce {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-3px);
      }
    }

    /* 5. HERO & CTA */
    .hero {
      position: relative;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: var(--surface);
      height: 60vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 0 1em;
      border-radius: 12px;
    }

    .hero h1 {
      font-size: 3rem;
      margin-bottom: .5em;
    }

    .hero p {
      font-size: 1.2rem;
    }

    .btn-cta {
      margin-top: 1em;
      background: var(--surface);
      color: var(--primary);
      padding: .75em 1.5em;
      border-radius: 10px;
      font-weight: 600;
      position: relative;
      overflow: hidden;
      transition: transform .2s, box-shadow .2s;
    }

    .btn-cta:hover,
    .btn-cta:focus {
      transform: scale(1.05);
      box-shadow: 0 6px 16px rgba(0, 0, 0, .15);
      outline: 2px solid var(--accent);
    }

    /* 6. SECTION HEADERS */
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1em;
    }

    .section-header h2 {
      position: relative;
      font-size: 2rem;
      font-weight: 600;
    }

    .section-header h2::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -6px;
      width: 50px;
      height: 3px;
      background: var(--accent);
      transition: width .3s;
    }

    .section-header h2:hover::after,
    .section-header h2:focus-within::after {
      width: 100px;
    }

    /* 7. DARK MODE TOGGLE BUTTON */
    #darkToggle {
      background: var(--surface);
      color: var(--primary);
      font-size: 1.2rem;
      border: none;
      border-radius: 8px;
      padding: .6em;
      cursor: pointer;
      transition: background .3s ease, color .3s ease, transform .2s ease, box-shadow .3s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    #darkToggle:hover,
    #darkToggle:focus {
      background: var(--accent);
      color: var(--surface);
      transform: scale(1.1);
      box-shadow: 0 0 12px rgba(255, 143, 0, 0.5);
      outline: 2px solid var(--accent);
    }

    body.dark #darkToggle {
      background: var(--surface);
      color: var(--accent);
      box-shadow: 0 0 10px rgba(255, 143, 0, 0.3);
    }

    /* 9. GRIDS & CARDS */
    .grid,
    .tools-grid,
    .donate-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 1.5em;
    }

    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5em;
      box-shadow: 0 4px 12px rgba(0, 0, 0, .05);
      opacity: 0;
      transform: translateY(20px);
      transition: opacity .6s ease-out, transform .6s ease-out, box-shadow .2s ease;
    }

    .card.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .card:hover,
    .card:focus-within {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, .1);
    }

    .card img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      margin-bottom: 1em;
    }

    .card h3 {
      margin-bottom: .5em;
      color: var(--fg);
      font-size: 1.2rem;
    }

    .card p {
      font-size: .95rem;
    }

    .card .btn {
      display: inline-block;
      margin-top: 1em;
      background: var(--primary);
      color: var(--surface);
      padding: .6em 1.2em;
      border-radius: 10px;
      font-weight: 500;
      transition: background .2s, box-shadow .2s;
    }

    .card .btn:hover,
    .card .btn:focus {
      background: var(--accent);
      box-shadow: 0 4px 12px rgba(0, 0, 0, .1);
      outline: 2px solid var(--accent);
    }


    #refreshRandom {
      background: var(--primary);
      color: var(--surface);
      padding: .4em .7em;
      border-radius: 10px;
      font-size: 1.2rem;
      border: none;
      cursor: pointer;
      transition: transform .2s ease, box-shadow .3s ease, background .2s ease;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    #refreshRandom:hover,
    #refreshRandom:focus {
      background: var(--accent);
      transform: rotate(-20deg) scale(1.1);
      box-shadow: 0 0 15px rgba(255, 143, 0, 0.5);
      outline: 2px solid var(--accent);
    }

    #refreshRandom:active {
      transform: scale(0.95);
      box-shadow: none;
    }

    /* 11. WIDGETS & DONATE CARDS */
    .widget,
    .donate-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5em;
      box-shadow: 0 4px 12px rgba(0, 0, 0, .05);
      transition: transform .2s, box-shadow .2s;
    }

    .widget:hover,
    .donate-card:hover,
    .widget:focus-within,
    .donate-card:focus-within {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, .1);
    }

    .widget h3,
    .donate-card h3 {
      margin-bottom: .8em;
      color: var(--fg);
    }

    /* 12. DONATE SECTION */
    .donate-section {
      background: var(--primary);
      color: var(--surface);
      text-align: center;
      padding: 3em 0;
      border-radius: 12px;
    }

    .donate-card img.qr {
      display: block;
      margin: 1em auto;
      width: 120px;
    }

    .donate-card ul {
      list-style: none;
      padding: 0;
      color: var(--surface);
    }

    .donate-card ul li {
      margin-bottom: .5em;
      font-size: .95rem;
    }


    /* 14. MODAL */
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, .6);
      align-items: center;
      justify-content: center;
      padding: 1em;
      z-index: 2000;
    }

    .modal-content {
      background: var(--surface);
      padding: 2em;
      border-radius: 12px;
      max-width: 400px;
      width: 100%;
      position: relative;
      color: var(--fg);
    }

    .close-btn {
      position: absolute;
      top: .5em;
      right: .5em;
      font-size: 1.5em;
      cursor: pointer;
    }

    /* 15. RIPPLE EFFECT */
    .btn {
      position: relative;
      overflow: hidden;
    }

    .btn .ripple {
      position: absolute;
      width: 80px;
      height: 80px;
      background: rgba(255, 255, 255, .4);
      border-radius: 50%;
      transform: scale(0);
      animation: ripple .6s ease-out;
    }

    @keyframes ripple {
      to {
        transform: scale(4);
        opacity: 0;
      }
    }

    /* 16. FOOTER */
    footer {
      text-align: center;
      padding: 2em 0;
      color: var(--muted);
      border-radius: 0 0 12px 12px;
    }

    /* 17. RESPONSIVE BREAKPOINTS */

    /* Ultra-small devices */
    @media (max-width: 480px) {
      .hero h1 {
        font-size: 1.8rem;
      }

      .hero p {
        font-size: 0.9rem;
      }

      .btn-cta {
        font-size: 0.9rem;
        padding: 0.5em 1em;
      }

      .section-header h2 {
        font-size: 1.5rem;
      }

      .modal-content {
        padding: 1.5em;
      }

      .card h3 {
        font-size: 1rem;
      }

      .card p {
        font-size: 0.85rem;
      }

      .utility {
        flex-direction: column;
        align-items: stretch;
      }

      #darkToggle {
        width: 100%;
        margin-bottom: 0.5rem;
      }
    }

    /* Mobile devices */
    @media (max-width: 768px) {
      .sticky {
        flex-direction: column;
        align-items: flex-start;
        position: relative;
        z-index: 999;
      }

      nav {
        width: 100%;
        position: relative;
      }

      .menu {
        position: fixed;
        top: 0;
        right: 0;
        width: 80%;
        height: 100vh;
        background: var(--surface);
        flex-direction: column;
        padding: 3em 1.5em;
        gap: 1.2em;
        transform: translateX(100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
        z-index: 2000;
        overflow-y: auto;
        display: flex;
      }

      .menu.open {
        transform: translateX(0);
      }

      .hamburger {
        display: flex;
        position: absolute;
        top: 1rem;
        right: 1rem;
        z-index: 2100;
      }

      .utility {
        flex-wrap: wrap;
        justify-content: flex-start;
        margin-top: 1rem;
      }

      .donate-grid,
      .grid,
      .tools-grid {
        grid-template-columns: 1fr;
      }

      .hero {
        height: auto;
        padding: 4em 1em;
      }

      .hero h1 {
        font-size: 2.2rem;
      }

      .hero p {
        font-size: 1rem;
      }
    }

    /* Tablet / small laptops */
    @media (min-width: 769px) and (max-width: 1024px) {

      .grid,
      .tools-grid,
      .donate-grid {
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      }

      .section-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5em;
      }

      .modal-content {
        max-width: 360px;
      }
    }

    /* Widescreen / 4K */
    @media (min-width: 1440px) {
      .container {
        max-width: 1400px;
      }

      .hero h1 {
        font-size: 3.4rem;
      }

      .hero p {
        font-size: 1.3rem;
      }

      .btn-cta {
        font-size: 1.1rem;
      }

      .grid,
      .tools-grid,
      .donate-grid {
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      }
    }
  </style>
</head>
<!-- Sticky Navbar -->
<header class="sticky">
  <div class="logo">Books of Ilm</div>

  <nav>
    <ul class="menu">
      <li><a href="#hero">Home</a></li>
      <!-- Navbar Menu Link -->
      <li class="has-sub">
        <a href="#">Library ‚ñº</a>
        <ul class="submenu">
          <li><a href="#randomBooks">Random Books</a></li>
          <li><a href="knowledge.html">All Books</a></li>
        </ul>
      </li>

      <li><a href="#tools">Tools</a></li>
      <li><a href="#donate">Donate</a></li>
    </ul>
  </nav>

  <div class="utility">
    <button id="darkToggle" title="Toggle dark mode">üåô</button>
  </div>

  <button id="hamburgerBtn" class="hamburger" aria-label="Toggle menu">
    <span></span>
    <span></span>
    <span></span>
  </button>
</header>

<!-- Hero Section -->
<section id="hero" class="hero">
  <div class="hero-content container">
    <h1>Books of Ilm</h1>
    <p>Your free PDF library of authentic Islamic knowledge.</p>
    <a href="knowledge.html" class="btn btn-cta">See Full Library</a>
  </div>
</section>

<!-- Random Books Section -->
<section id="randomBooks" class="grid-section container alt">
  <div class="section-header">
    <h2>üìö Random Books</h2>
    <button id="refreshRandom" title="Surprise Me">üîÑ</button>
  </div>
 <div class="grid" id="jsonBookGrid">
  <!-- JSON-loaded books will appear here -->
</div>

</section>


<!-- Tools Section -->
<section id="tools" class="grid-section container">
  <div class="section-header">
    <h2>üï∞Ô∏è Prayer & Tools</h2>
  </div>
  <div class="tools-grid">
    <div class="widget prayer">
      <h3>Prayer Times</h3>
      <label for="calcMethod">Method</label>
      <select id="calcMethod">
        <option value="8">Umm al-Qura</option>
        <option value="5">Karachi</option>
      </select>
      <ul id="prayerList">
        <!-- prayer times injected here -->
      </ul>
    </div>
    <div class="widget hijri">
      <h3>Hijri Date</h3>
      <div id="hijriDate">Loading‚Ä¶</div>
    </div>
    <div class="widget qibla">
      <h3>Qibla Direction</h3>
      <div id="compass">Loading‚Ä¶</div>
    </div>
    <div class="widget converter">
      <h3>Date Converter</h3>
      <input type="date" id="greg" />
      <button id="convertBtn" class="btn">Convert</button>
      <div id="converted"></div>
    </div>
  </div>
</section>

<!-- Donate Section -->
<section id="donate" class="donate-section container">
  <h2>üíñ Support Us</h2>
  <p>Your donations keep these books free and accessible. Choose any method:</p>
  <div class="donate-grid">
    <div class="donate-card paypal">
      <img src="images/paypal.svg" alt="PayPal" />
      <h3>PayPal</h3>
      <a href="https://www.paypal.com/donate?hosted_button_id=YOUR_ID" target="_blank" class="btn">
        Donate via PayPal
      </a>
    </div>
    <div class="donate-card stripe">
      <img src="images/credit-card.svg" alt="Card" />
      <h3>Credit / Debit Card</h3>
      <button id="stripeBtn" class="btn">Donate with Card</button>
    </div>
    <div class="donate-card upi">
      <img src="images/upi.svg" alt="UPI" />
      <h3>UPI (India)</h3>
      <img src="images/upi-qr.png" alt="Scan UPI" class="qr" />
      <p>Scan with Google Pay, PhonePe, etc.</p>
    </div>
    <div class="donate-card bank">
      <img src="images/bank.svg" alt="Bank" />
      <h3>Bank Transfer</h3>
      <ul>
        <li><strong>Account:</strong> Books of Ilm</li>
        <li><strong>No:</strong> 1234567890</li>
        <li><strong>IFSC:</strong> ABCD0123456</li>
        <li><strong>Bank:</strong> Your Bank Name</li>
      </ul>
    </div>
  </div>
</section>

<!-- Floating Buttons -->
<button id="feedbackBtn" class="floating-feedback" title="Report Issue / Request Book">
  üìù
</button>
<button id="backToTop" class="floating-top" title="Back to Top">
  ‚Üë
</button>

<!-- Footer -->
<footer class="container">
  <p>&copy; 2025 Books of Ilm. All rights reserved.</p>
</footer>
<script>
  // Helper: Shuffle array
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// Load Random Books from books.json
function loadRandomBooks(count = 15) {
  fetch('public/books.json') // üëà Updated path
    .then(res => res.json())
    .then(books => {
      const selected = shuffleArray(books).slice(0, count);
      const container = document.getElementById('jsonBookGrid');
      container.innerHTML = '';

      selected.forEach(book => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <img
            loading="lazy"
            src="${book.thumb}"
            alt="${book.name}"
            onerror="this.src='public/thumbnails/placeholder.png'"
          />
          <h3>${book.name}</h3>
          <p>Size: ${book.size}</p>
          <a href="${book.file}" class="btn" download>Download PDF</a>
        `;
        container.appendChild(card);
        if (typeof observer !== 'undefined') observer.observe(card);
      });
    })
    .catch(err => console.error('Error loading books.json:', err));
}

// Init on DOM load
document.addEventListener('DOMContentLoaded', () => {
  loadRandomBooks();
  document.getElementById('refreshRandom')
          .addEventListener('click', () => loadRandomBooks());
});

</script>
<script>
  // A) DARK MODE MEMORY + EMOJI
  const darkToggle = document.getElementById('darkToggle');
  const iconMap = { dark: '‚òÄÔ∏è', light: 'üåô' };

  // Apply stored mode on load
  if (localStorage.getItem('dark') === 'true') {
    document.body.classList.add('dark');
  }

  // Update toggle icon
  function updateDarkIcon() {
    const isDark = document.body.classList.contains('dark');
    darkToggle.textContent = isDark ? iconMap.dark : iconMap.light;
  }
  updateDarkIcon();

  // Toggle dark mode, save state, swap icon
  darkToggle.addEventListener('click', () => {
    const isDark = document.body.classList.toggle('dark');
    localStorage.setItem('dark', isDark);
    updateDarkIcon();
  });

// Show Back to Top on scroll
window.addEventListener('scroll', () => {
  document.getElementById('backToTop').style.display =
    window.scrollY > 300 ? 'block' : 'none';
});

// Back to Top Functionality
document.getElementById('backToTop').addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

  // D) HAMBURGER MENU TOGGLE
  const hamburger = document.getElementById('hamburgerBtn');
  const menu = document.querySelector('.menu');

  hamburger.addEventListener('click', () => {
    hamburger.classList.toggle('active');
    menu.classList.toggle('open');
  });

  // G) CARD CREATION & OBSERVER
  function createCard(book, container) {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
    <img loading="lazy" src="${book.cover}" alt="${book.title}" />
    <h3>${book.title}</h3>
    <p>${book.desc}</p>
    <a href="pdfs/${book.file}" class="btn" download>Download PDF</a>
  `;
    container.appendChild(card);
    observer.observe(card);
  }


  // H) ON-SCROLL FADE-IN
  const observer = new IntersectionObserver((entries, obs) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        obs.unobserve(entry.target);
      }
    });
  }, { threshold: 0.1 });

  const footerEl = document.querySelector('footer');
  if (footerEl) observer.observe(footerEl);


  // I) SMOOTH SCROLL FOR ANCHORS
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', e => {
      e.preventDefault();
      const target = document.querySelector(anchor.getAttribute('href'));
      if (target) {
        target.scrollIntoView({ behavior: 'smooth' });
      }
    });
  });


  // J) GEOLOCATION ‚Üí PRAYER TIMES, HIJRI & QIBLA
  const prayerList = document.getElementById('prayerList');
  const hijriDate = document.getElementById('hijriDate');
  const compass = document.getElementById('compass');
  const calcMethod = document.getElementById('calcMethod');

  function onGeoSuccess({ coords: { latitude: lat, longitude: lng } }) {
    loadPrayerHijri(lat, lng);
    loadQibla(lat, lng);
  }

  function onGeoError(err) {
    console.warn('Geolocation failed:', err.message);
    // Fallback to Makkah
    loadPrayerHijri(21.422487, 39.826206);
    loadQibla(21.422487, 39.826206);
  }

  navigator.geolocation.getCurrentPosition(onGeoSuccess, onGeoError, {
    enableHighAccuracy: true,
    timeout: 10000,
    maximumAge: 0
  });

  calcMethod.addEventListener('change', () => {
    navigator.geolocation.getCurrentPosition(onGeoSuccess, onGeoError);
  });

  function loadPrayerHijri(lat, lng) {
    fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lng}&method=${calcMethod.value}`)
      .then(res => res.json())
      .then(json => {
        const t = json.data.timings;
        const h = json.data.date.hijri;
        prayerList.innerHTML = '';
        ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'].forEach(name => {
          const li = document.createElement('li');
          li.textContent = `${name}: ${t[name]}`;
          prayerList.appendChild(li);
        });
        hijriDate.textContent = `${h.day} ${h.month.en} ${h.year}`;
      })
      .catch(e => console.error('Aladhan error:', e));
  }

  function loadQibla(lat, lng) {
    fetch(`https://api.aladhan.com/v1/qibla/${lat}/${lng}`)
      .then(res => res.json())
      .then(json => {
        compass.textContent = `${json.data.direction.toFixed(1)}¬∞ from North`;
      })
      .catch(e => console.error('Qibla API error:', e));
  }


  // K) DATE CONVERTER
  const gregInput = document.getElementById('greg');
  const convertBtn = document.getElementById('convertBtn');
  const converted = document.getElementById('converted');

  convertBtn.addEventListener('click', () => {
    const d = new Date(gregInput.value);
    if (isNaN(d)) {
      converted.textContent = 'Invalid date';
      return;
    }
    converted.textContent = new Intl.DateTimeFormat('en-u-ca-islamic', {
      day: 'numeric',
      month: 'long',
      year: 'numeric'
    }).format(d);
  });


  // L) STRIPE CHECKOUT FOR CARD DONATIONS
  const stripe = Stripe('pk_test_YOUR_PUBLISHABLE_KEY');
  document.getElementById('stripeBtn').addEventListener('click', () => {
    fetch('/create-stripe-session', { method: 'POST' })
      .then(r => r.json())
      .then(data => stripe.redirectToCheckout({ sessionId: data.sessionId }))
      .catch(e => console.error('Stripe error:', e));
  });


  // N) RIPPLE EFFECT ON ALL .btn ELEMENTS
  document.querySelectorAll('.btn').forEach(btn => {
    btn.addEventListener('click', e => {
      const circle = document.createElement('span');
      circle.className = 'ripple';
      btn.appendChild(circle);
      setTimeout(() => circle.remove(), 600);
    });
  });

</script>
</body>

</html>